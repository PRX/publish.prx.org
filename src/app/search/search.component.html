<div class="main">
  <section>
    <header>
      <h2>Do a search for...</h2>

      <publish-search-series
        *ngIf="isOnSeriesTab()"
        (searchSeriesByText)="searchByText($event)"
        (searchSeriesByGenre)="searchSeriesByGenre($event)">
      </publish-search-series>

      <publish-search-story
        *ngIf="isOnStoriesTab()"
        [searchSeriesId]="searchSeriesId"
        [allSeriesIds]="allSeriesIds"
        [allSeries]="allSeries"
        (searchStoriesByText)="searchByText($event)"
        (searchStoriesBySeries)="searchStoriesBySeries($event)">
      </publish-search-story>

      <div>
        <button (click)="searchSeriesTab()" class="tab" [ngClass]="{'active': isOnSeriesTab()}" [disabled]="isOnSeriesTab()">Series</button>
        <button (click)="searchStoriesTab()" class="tab" [ngClass]="{'active': isOnStoriesTab()}" [disabled]="isOnStoriesTab()">Stories</button>

        <span class="pages">
          <button *ngIf="totalCount && pages?.length > 1" (click)="search(1, totalCount)" class="btn-link">View All {{totalCount}} &raquo;</button>
          <button disabled *ngIf="totalCount && pages?.length === 1" class="btn-link">Viewing {{totalCount > 1 ? 'all ' + totalCount : totalCount}}</button>
        </span>

        <span *ngIf="pages?.length > 1" class="pages">
          <button [disabled]="currentPage === 1" (click)="search(currentPage - 1)" class="btn-link">&lt;</button>
          <button *ngFor="let page of pages | slice:pagesBegin:pagesEnd;"
                  [disabled]="page === currentPage" [ngClass]="{'active': page === currentPage}"
                  (click)="search(page)"
                  class="btn-link">{{page}}</button>
          <button disabled *ngIf="pages.length > showNumPages" class="btn-link">of {{pages.length}}</button>
          <button [disabled]="currentPage === pages?.length" (click)="search(currentPage + 1)" class="btn-link">&gt;</button>
        </span>
      </div>
    </header>

    <publish-spinner *ngIf="!isLoaded"></publish-spinner>
    <publish-story-list
      *ngIf="isOnStoriesTab()"
      [noStories]="noResults"
      [stories]="storiesResults"
      [loaders]="loaders"></publish-story-list>

    <publish-series-list
      *ngIf="isOnSeriesTab()"
      [noSeries]="noResults"
      [series]="seriesResults"
      [loaders]="loaders"></publish-series-list>
  </section>
</div>
